"use strict";function findMoney(e,t,o,n){$.ajax({type:"get",url:"/index/findMoney",data:{year:e,month:t,day:o,userId:n},success:function(e){console.log(e)}})}function setCookie(e,t,o){var n=new Date;n.setDate(n.getDate()+o),document.cookie=e+"="+decodeURI(t)+(null==o?"":";expires="+n.toGMTString())}function getCookie(e){var t=null,o=null;return document.cookie.length>0&&-1!=(t=document.cookie.indexOf(e+"="))?(t=t+e.length+1,-1==(o=document.cookie.indexOf(";",t))?document.cookie.slice(t):document.cookie.slice(t,o)):""}$("#showInput").click(function(){var e=new Date;$("#time").html("当前时间:"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()),$(".input_money").addClass("showInput")}),$("#cancel_btn").click(function(){$(".input_money").removeClass("showInput")}),$("#account").click(function(){window.location.href="/home.html"}),$("#contact_me").click(function(){window.location.href="/contact.html"}),$("#logout").click(function(){$.ajax({type:"get",url:"/users/logout",success:function(){window.location.href="/index.html"}})});var myDate=new Date,year=myDate.getFullYear(),month=myDate.getMonth()+1,day=myDate.getDate(),url=window.location.href,session_user=url.slice(url.lastIndexOf("/")+1,url.lastIndexOf(".")),userData=null;"home"!=session_user&&"contact"!=session_user||$.ajax({type:"get",url:"/users/getSession",success:function(e){console.log(e._id),void 0==e._id?window.location.href="/index.html":(userData=e,findMoney(year,month,"",e._id))}}),$("#submit").click(function(){var e=$("#contact_content").val();if(""==e||null==e)return $(".tip").html("内容不能为空"),void $(".tip").css({color:"#ff6d6d"});$.ajax({type:"get",url:"/index/contactme",data:{userId:userData._id,contact:e},success:function(){$(".tip").html("成功提交"),$(".tip").css({color:"green"}),$("#submit").hide()}})}),$("#addmoney_btn").click(function(){var e=$("#payorget>.active>input").val(),t=$("#remark").val(),o=+$("#money").val();""!=t?""==o||o<=0?$(".moneytip").html("金额不能为空和负数"):(e<0&&(o*=-1),$.ajax({type:"post",url:"/index/addMoney",data:{year:year,month:month,day:day,remark:t,money:o,userId:userData._id},success:function(){$(".input_money").removeClass("showInput")}})):$(".remarktip").html("备注信息不能为空")});var cook_user=getCookie("user"),cook_password=getCookie("password");""!=cook_user&&""!=cook_password&&($("#logusername").val(cook_user),$("#logpassword").val(cook_password)),$("#login_bth").click(function(){var e=$("#logusername").val(),t=$("#logpassword").val(),o=$("#remberme").is(":checked");return""==e?($(".messageuser_tip").html("用户名不能为空"),!1):""==t?($(".messagepwd_tip").html("密码不能为空"),!1):void $.ajax({type:"post",url:"/users/login",data:{username:e,pwd:t},success:function(n){1==n.status?$(".messagepwd_tip").html("用户名或密码不正确"):o?(setCookie("user",e,365),setCookie("password",t,365),window.location.href="/home.html"):window.location.href="/home.html"}})});var user={content:"",sure:!1},password={content:"",sure:!1},comfirmpwd={sure:!1};$("#regname").change(function(){var e=$("#regname").val();""==e?($(".regname").html("用户名不能为空"),user.sure=!1):/^([a-z]|[0-9]){6,16}$/gi.test(e)?$.ajax({type:"get",url:"/users/validate",data:{username:e},success:function(t){0==t.status?($(".regname").html("用户名重复"),user.sure=!1):($(".regname").html(""),user.sure=!0,user.content=e)}}):($(".regname").html("用户名格式不正确"),user.sure=!1)}),$("#regpwd").change(function(){var e=$("#regpwd").val();""==e?($(".regpwd").html("密码不能为空"),password.sure=!1):/^([a-z]|[0-9]){6,16}$/gi.test(e)?($(".regpwd").html(""),password.sure=!0,password.content=e):($(".regpwd").html("密码格式不正确"),password.sure=!1)}),$("#regcompwd").change(function(){$("#regcompwd").val()!=$("#regpwd").val()?($(".regcompwd").html("密码不一致"),comfirmpwd.sure=!1):($(".regcompwd").html(""),comfirmpwd.sure=!0)}),$("#login_bth").click(function(){user.sure&&password.sure&&comfirmpwd.sure&&$.ajax({type:"post",url:"/users/register",data:{username:user.content,password:password.content},success:function(){console.log("success"),window.location.href="/index.html"}})});